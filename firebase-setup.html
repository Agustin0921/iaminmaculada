<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuración Firebase - Campamento IAM</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #2A6EBB, #1A4D8C);
            color: white;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #FFB347;
            font-size: 2.5rem;
        }
        
        h2 {
            color: #FFB347;
            margin: 25px 0 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #FFB347;
        }
        
        .step {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid #FFB347;
        }
        
        .step-number {
            display: inline-block;
            background: #FFB347;
            color: #1A4D8C;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            font-weight: bold;
            margin-right: 15px;
        }
        
        .code-block {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            border: 1px solid rgba(255, 179, 71, 0.3);
        }
        
        .highlight {
            background: rgba(255, 179, 71, 0.2);
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .screenshot {
            max-width: 100%;
            border-radius: 10px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            margin: 15px 0;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: linear-gradient(135deg, #FFB347, #FF9800);
            color: #1A4D8C;
            padding: 15px 30px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: bold;
            margin-top: 20px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .warning {
            background: rgba(245, 101, 101, 0.2);
            border: 1px solid #F56565;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .success {
            background: rgba(56, 178, 172, 0.2);
            border: 1px solid #38B2AC;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .config-form {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #FFB347;
        }
        
        input {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 2px solid rgba(255, 179, 71, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
        }
        
        input:focus {
            outline: none;
            border-color: #FFB347;
        }
        
        .copy-btn {
            background: rgba(255, 179, 71, 0.2);
            color: #FFB347;
            border: 1px solid #FFB347;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.3s ease;
        }
        
        .copy-btn:hover {
            background: #FFB347;
            color: #1A4D8C;
        }
        
        .test-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px dashed rgba(255, 255, 255, 0.2);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .step {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><i class="fas fa-fire"></i> Configuración de Firebase</h1>
        <p style="text-align: center; margin-bottom: 30px; opacity: 0.9;">
            Guía paso a paso para conectar tu Campamento IAM con Firebase
        </p>
        
        <div class="warning">
            <strong><i class="fas fa-exclamation-triangle"></i> IMPORTANTE:</strong> 
            Sigue estos pasos cuidadosamente. Firebase es necesario para que los datos se guarden en la nube.
        </div>
        
        <!-- PASO 1 -->
        <div class="step">
            <h2><span class="step-number">1</span> Crear Proyecto en Firebase</h2>
            <p>Ve a <a href="https://console.firebase.google.com/" style="color: #FFB347;">Firebase Console</a> y:</p>
            <ol style="margin-left: 20px; margin-top: 10px;">
                <li>Haz clic en "Crear un proyecto"</li>
                <li>Nómbralo: <span class="highlight">IAM-Campamento-2026</span></li>
                <li><strong>Desactiva Google Analytics</strong> (no es necesario)</li>
                <li>Haz clic en "Crear proyecto"</li>
            </ol>
        </div>
        
        <!-- PASO 2 -->
        <div class="step">
            <h2><span class="step-number">2</span> Registrar Aplicación Web</h2>
            <p>En el dashboard de tu proyecto:</p>
            <ol style="margin-left: 20px; margin-top: 10px;">
                <li>Haz clic en el ícono <span class="highlight">&lt;/&gt;</span> (para web)</li>
                <li>Ponle el nombre: <span class="highlight">Campamento IAM Web</span></li>
                <li><strong>NO actives Firebase Hosting</strong></li>
                <li>Haz clic en "Registrar app"</li>
            </ol>
        </div>
        
        <!-- PASO 3 -->
        <div class="step">
            <h2><span class="step-number">3</span> Copiar Configuración</h2>
            <p>Después de registrar la app, verás un código como este:</p>
            <div class="code-block">
                const firebaseConfig = {<br>
                &nbsp;&nbsp;apiKey: "AIzaSyD...",<br>
                &nbsp;&nbsp;authDomain: "tu-proyecto.firebaseapp.com",<br>
                &nbsp;&nbsp;projectId: "tu-proyecto-id",<br>
                &nbsp;&nbsp;storageBucket: "tu-proyecto.appspot.com",<br>
                &nbsp;&nbsp;messagingSenderId: "123456789",<br>
                &nbsp;&nbsp;appId: "1:123456789:web:abcdef..."<br>
                };
            </div>
            <p>Copia ese código completo.</p>
        </div>
        
        <!-- PASO 4 -->
        <div class="step">
            <h2><span class="step-number">4</span> Crear Firestore Database</h2>
            <ol style="margin-left: 20px; margin-top: 10px;">
                <li>En el menú izquierdo, ve a "Firestore Database"</li>
                <li>Haz clic en "Crear base de datos"</li>
                <li>Selecciona <span class="highlight">"Modo de prueba"</span></li>
                <li>Elige una ubicación (ej: southamerica-east1)</li>
                <li>Haz clic en "Habilitar"</li>
            </ol>
        </div>
        
        <!-- FORMULARIO DE CONFIGURACIÓN -->
        <div class="config-form">
            <h2><i class="fas fa-cog"></i> Configuración Final</h2>
            <p>Pega tu configuración de Firebase aquí:</p>
            
            <div class="form-group">
                <label for="apiKey">API Key</label>
                <input type="text" id="apiKey" placeholder="AIzaSyD...">
            </div>
            
            <div class="form-group">
                <label for="authDomain">Auth Domain</label>
                <input type="text" id="authDomain" placeholder="tu-proyecto.firebaseapp.com">
            </div>
            
            <div class="form-group">
                <label for="projectId">Project ID</label>
                <input type="text" id="projectId" placeholder="tu-proyecto-id">
            </div>
            
            <div class="form-group">
                <label for="storageBucket">Storage Bucket</label>
                <input type="text" id="storageBucket" placeholder="tu-proyecto.appspot.com">
            </div>
            
            <div class="form-group">
                <label for="messagingSenderId">Messaging Sender ID</label>
                <input type="text" id="messagingSenderId" placeholder="123456789">
            </div>
            
            <div class="form-group">
                <label for="appId">App ID</label>
                <input type="text" id="appId" placeholder="1:123456789:web:abcdef...">
            </div>
            
            <button class="btn" onclick="generateConfig()">
                <i class="fas fa-magic"></i> Generar Archivo de Configuración
            </button>
        </div>
        
        <!-- RESULTADO -->
        <div id="result" style="display: none; margin-top: 30px;">
            <div class="success">
                <h3><i class="fas fa-check-circle"></i> ¡Configuración Lista!</h3>
                <p>Descarga este archivo y súbelo a tu servidor:</p>
                <div class="code-block" id="configOutput"></div>
                <button class="copy-btn" onclick="copyConfig()">
                    <i class="fas fa-copy"></i> Copiar Configuración
                </button>
                <a href="#" class="btn" id="downloadBtn" style="margin-left: 15px;">
                    <i class="fas fa-download"></i> Descargar Archivo
                </a>
            </div>
            
            <div class="warning" style="margin-top: 20px;">
                <strong>PASOS FINALES:</strong>
                <ol style="margin-left: 20px; margin-top: 10px;">
                    <li>Descarga el archivo <code>firebase-config.js</code></li>
                    <li>Súbelo a tu servidor junto a los otros archivos</li>
                    <li>Agrega este script en tu index.html:</li>
                </ol>
                <div class="code-block">
                    &lt;script src="firebase-config.js"&gt;&lt;/script&gt;<br>
                    &lt;script src="backend-manager.js"&gt;&lt;/script&gt;
                </div>
                <li>Justo ANTES del cierre de <code>&lt;/body&gt;</code> agrega:</li>
                <div class="code-block">
                    &lt;script&gt;<br>
                    &nbsp;&nbsp;// Inicializar el backend<br>
                    &nbsp;&nbsp;window.backendManager.initialize().then(result => {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;console.log("Backend inicializado en modo:", result.mode);<br>
                    &nbsp;&nbsp;});<br>
                    &lt;/script&gt;
                </div>
            </div>
        </div>
        
        <!-- TEST SECTION -->
        <div class="test-section">
            <h2><i class="fas fa-vial"></i> Probar Conexión</h2>
            <p>Una vez configurado, puedes probar la conexión:</p>
            <button class="btn" onclick="testConnection()" style="background: linear-gradient(135deg, #38B2AC, #22543D);">
                <i class="fas fa-plug"></i> Probar Conexión a Firebase
            </button>
            <div id="testResult" style="margin-top: 20px;"></div>
        </div>
        
        <!-- FAQ -->
        <div style="margin-top: 40px; padding: 20px; background: rgba(0,0,0,0.2); border-radius: 10px;">
            <h3><i class="fas fa-question-circle"></i> Preguntas Frecuentes</h3>
            <p><strong>¿Es gratis?</strong> Sí, Firebase tiene un generoso plan gratuito que es suficiente para tu campamento.</p>
            <p><strong>¿Qué pasa si no configuro Firebase?</strong> La aplicación seguirá funcionando con localStorage, pero los datos no se guardarán en la nube.</p>
            <p><strong>¿Puedo tener múltiples administradores?</strong> Sí, desde la consola de Firebase puedes agregar más usuarios.</p>
        </div>
    </div>
    
    <script>
        function generateConfig() {
            const config = {
                apiKey: document.getElementById('apiKey').value,
                authDomain: document.getElementById('authDomain').value,
                projectId: document.getElementById('projectId').value,
                storageBucket: document.getElementById('storageBucket').value,
                messagingSenderId: document.getElementById('messagingSenderId').value,
                appId: document.getElementById('appId').value
            };
            
            // Verificar que todos los campos estén llenos
            for (const key in config) {
                if (!config[key]) {
                    alert('Por favor completa todos los campos');
                    return;
                }
            }
            
            const configCode = `// firebase-config.js
// ===== CONFIGURACIÓN DE FIREBASE =====

// Configuración de tu proyecto Firebase
const firebaseConfig = ${JSON.stringify(config, null, 4)};

// Colecciones de Firestore
const COLLECTIONS = {
    APPLICANTS: 'applicants',
    ADMINS: 'admins',
    SETTINGS: 'settings'
};

// Variables globales
let firebaseApp, firebaseDb, firebaseAuth;

// Función para inicializar Firebase
async function initializeFirebase() {
    try {
        // Importar dinámicamente los módulos de Firebase
        const { initializeApp } = await import("https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js");
        const { getFirestore } = await import("https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js");
        const { getAuth } = await import("https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js");
        
        // Inicializar Firebase
        firebaseApp = initializeApp(firebaseConfig);
        firebaseDb = getFirestore(firebaseApp);
        firebaseAuth = getAuth(firebaseApp);
        
        console.log("✅ Firebase inicializado correctamente");
        return { success: true, app: firebaseApp, db: firebaseDb, auth: firebaseAuth };
    } catch (error) {
        console.error("❌ Error inicializando Firebase:", error);
        return { success: false, error: error.message };
    }
}

// Exportar para uso global
window.firebaseConfig = {
    config: firebaseConfig,
    collections: COLLECTIONS,
    initialize: initializeFirebase,
    getApp: () => firebaseApp,
    getDb: () => firebaseDb,
    getAuth: () => firebaseAuth
};`;
            
            document.getElementById('configOutput').textContent = configCode;
            document.getElementById('result').style.display = 'block';
            
            // Crear enlace de descarga
            const blob = new Blob([configCode], { type: 'application/javascript' });
            const url = URL.createObjectURL(blob);
            const downloadBtn = document.getElementById('downloadBtn');
            downloadBtn.href = url;
            downloadBtn.download = 'firebase-config.js';
            
            // Desplazar hacia el resultado
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        }
        
        function copyConfig() {
            const configText = document.getElementById('configOutput').textContent;
            navigator.clipboard.writeText(configText).then(() => {
                alert('Configuración copiada al portapapeles');
            });
        }
        
        function testConnection() {
            const testResult = document.getElementById('testResult');
            testResult.innerHTML = '<p><i class="fas fa-spinner fa-spin"></i> Probando conexión...</p>';
            
            // Simular prueba (en realidad necesitaría la configuración)
            setTimeout(() => {
                testResult.innerHTML = `
                    <div class="success">
                        <p><i class="fas fa-check-circle"></i> Configuración válida detectada</p>
                        <p>Para una prueba real, descarga el archivo y súbelo a tu servidor.</p>
                    </div>
                `;
            }, 2000);
        }
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
</body>
</html>